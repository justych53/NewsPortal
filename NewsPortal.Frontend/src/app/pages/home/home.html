<main class="main-content">
  <app-image-slider></app-image-slider>

  <div class="container">
    <section class="news-section">
      <h2 class="section-title">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏</h2>

      <!-- –ü–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤ -->
      <div class="filters-panel">
        <div class="filter-group">
          <label for="categoryFilter">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
          <select id="categoryFilter"
                  [(ngModel)]="selectedCategory"
                  (change)="onCategoryChange(selectedCategory)"
                  class="filter-select">
            <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
            <option *ngFor="let category of categories" [value]="category.id">
              {{ category.name }}
            </option>
          </select>
        </div>

        <div class="filter-group">
          <label for="dateFilter">–î–∞—Ç–∞:</label>
          <select id="dateFilter"
                  [(ngModel)]="dateFilter"
                  (change)="onDateFilterChange(dateFilter)"
                  class="filter-select">
            <option value="all">–ó–∞ –≤—Å–µ –≤—Ä–µ–º—è</option>
            <option value="today">–°–µ–≥–æ–¥–Ω—è</option>
            <option value="week">–ó–∞ –Ω–µ–¥–µ–ª—é</option>
            <option value="month">–ó–∞ –º–µ—Å—è—Ü</option>
          </select>
        </div>

        <div class="filter-group">
          <label for="searchInput">–ü–æ–∏—Å–∫:</label>
          <div class="search-box">
            <input id="searchInput"
                   type="text"
                   [(ngModel)]="searchQuery"
                   placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–æ–≤–æ—Å—Ç—è–º..."
                   (keyup.enter)="onSearch()"
                   class="search-input">
            <button (click)="onSearch()" class="search-btn">üîç</button>
          </div>
        </div>

        <button (click)="clearFilters()"
                class="clear-filters-btn"
                [disabled]="selectedCategory === 'all' && dateFilter === 'all' && !searchQuery">
          –°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
        </button>
      </div>

      <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∏–ª—å—Ç—Ä–∞—Ö -->
      <div *ngIf="selectedCategory !== 'all' || dateFilter !== 'all' || searchQuery" class="filter-info">
        <p>
          –ü–æ–∫–∞–∑–∞–Ω–æ: {{ filteredNews.length }} –∏–∑ {{ newsArticles.length }} –Ω–æ–≤–æ—Å—Ç–µ–π
          <span *ngIf="selectedCategory !== 'all'">
            ‚Ä¢ –ö–∞—Ç–µ–≥–æ—Ä–∏—è: {{ getCategoryName(selectedCategory) }}
          </span>
          <span *ngIf="dateFilter !== 'all'">
            ‚Ä¢ –ü–µ—Ä–∏–æ–¥: {{ getDateFilterText() }}
          </span>
          <span *ngIf="searchQuery">
            ‚Ä¢ –ü–æ–∏—Å–∫: "{{ searchQuery }}"
          </span>
        </p>
      </div>

      <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
      <div *ngIf="isLoading" class="loading">
        <p>–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π...</p>
      </div>

      <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ -->
      <div *ngIf="error && !isLoading" class="error">
        <p>{{ error }}</p>
        <button (click)="loadNews()" class="btn-primary">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞</button>
      </div>

      <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –µ—Å–ª–∏ –Ω–æ–≤–æ—Å—Ç–µ–π –Ω–µ—Ç -->
      <div *ngIf="!isLoading && !error && filteredNews.length === 0" class="no-news">
        <p *ngIf="selectedCategory !== 'all' || dateFilter !== 'all' || searchQuery">
          –ü–æ –≤–∞—à–∏–º —Ñ–∏–ª—å—Ç—Ä–∞–º –Ω–æ–≤–æ—Å—Ç–µ–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ø–æ–∏—Å–∫–∞.
        </p>
        <p *ngIf="selectedCategory === 'all' && dateFilter === 'all' && !searchQuery">
          –ù–æ–≤–æ—Å—Ç–µ–π –ø–æ–∫–∞ –Ω–µ—Ç. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º, –∫—Ç–æ –¥–æ–±–∞–≤–∏—Ç –Ω–æ–≤–æ—Å—Ç—å!
        </p>
        <button *ngIf="selectedCategory !== 'all' || dateFilter !== 'all' || searchQuery"
                (click)="clearFilters()"
                class="btn-primary">
          –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –Ω–æ–≤–æ—Å—Ç–∏
        </button>
      </div>

      <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
      <div *ngIf="filteredNews.length > 0" class="pagination-controls">
        <button (click)="previousPage()"
                [disabled]="currentPage === 1 || isLoading"
                class="pagination-btn">
          ‚Üê –ù–∞–∑–∞–¥
        </button>

        <span class="page-info">
          –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ currentPage }} –∏–∑ {{ totalPages }}
        </span>

        <button (click)="nextPage()"
                [disabled]="currentPage === totalPages || isLoading"
                class="pagination-btn">
          –í–ø–µ—Ä–µ–¥ ‚Üí
        </button>
      </div>

      <!-- –°–µ—Ç–∫–∞ –Ω–æ–≤–æ—Å—Ç–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫ -->
      <div *ngIf="!isLoading && filteredNews.length > 0" class="news-grid">
        <div *ngFor="let news of paginatedNews" class="news-card" (click)="openNewsPage(news.id)">
          <div class="news-content">
            <div class="news-header">
              <span class="news-category">{{ getCategoryName(news.categoryId) }}</span>
              <span class="news-date">{{ formatDate(news.createdAt) }}</span>
            </div>

            <h3 class="news-title">{{ news.title }}</h3>

            <p *ngIf="news.shortPhrase" class="news-short">
              {{ news.shortPhrase }}
            </p>
          </div>
        </div>
      </div>

      <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –≤–Ω–∏–∑—É -->
      <div *ngIf="filteredNews.length > 0" class="pagination-controls bottom">
        <button (click)="previousPage()"
                [disabled]="currentPage === 1 || isLoading"
                class="pagination-btn">
          ‚Üê –ù–∞–∑–∞–¥
        </button>

        <div class="page-numbers">
          <span *ngFor="let page of getPageNumbers()"
                [class.active]="page === currentPage"
                (click)="goToPage(page)"
                class="page-number">
            {{ page }}
          </span>
        </div>

        <button (click)="nextPage()"
                [disabled]="currentPage === totalPages || isLoading"
                class="pagination-btn">
          –í–ø–µ—Ä–µ–¥ ‚Üí
        </button>
      </div>
    </section>
  </div>
</main>

<footer class="footer">
  <div class="container">
    <p>&copy; 2024 –ù–æ–≤–æ—Å—Ç–Ω–∏–∫. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
  </div>
</footer>
